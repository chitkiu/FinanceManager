sudo: false
language: android
jdk: oraclejdk8
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
env:
  global:
  - ANDROID_API_LEVEL=28
  - ANDROID_BUILD_TOOLS_VERSION=28.0.3
  - ANDROID_ABI=google_apis/armeabi-v7a
  - ADB_INSTALL_TIMEOUT=20
android:
  components:
  - tools
  - platform-tools
  - build-tools-28.0.3
  - android-28
  - extra-google-m2repository
  - extra-android-m2repository
  - extra-google-google_play_services
  - extra-android-support
  - addon-google_apis-google-$ANDROID_API_LEVEL
script:
- "./gradlew clean"
- "./gradlew assembleDebug"

before_install:
- mkdir "$ANDROID_HOME/licenses" || true
- echo -e "\nd56f5187479451eabf01fb78af6dfcb131a6481e" > "$ANDROID_HOME/licenses/android-sdk-license"
- echo -e "\n84831b9409646a918e30573bab4c9c91346d8abd" > "$ANDROID_HOME/licenses/android-sdk-preview-license"
- chmod +x gradlew

deploy:
  provider: releases
  api_key:
    secure: mB5/d3gmYO1QXi78jt2P+QDK86A1YKbVlkB8VnvKdV4Ulf7wXv+Ck9xYyoo070GrK2Gwuh3k9QMNxc3AJot8CfRrPhqAjuiDLYGgZG/L4PatrUr+C/MBRQW6sB7sxgQgY+InijvNvX+vMyt2Rl/W5qXFNpDqtr9dZhkoOrsMhd6r70dAs+8LIktDILKquk+VqZAN03yIC4xoHCBXjvroJQzb66FYFEV5omFoQopx9LSSGDoQ3BDju8wueZbG6zG/IqpROz4hpgMibhzC9H58zme5bYfsytups9D74cwfmNmyirh2l1mcnVHWcKCIO/TnSj8CU+ZAB8rOkXL2xJhTs0G3B/2OxbPAD1LYHTnE18xt9pnM9J4ZMJz7eKQ2INcKW7iMhT66rVBhgyLw3++8fp+CcgdO3bxz5LdimGbW/qNaPeh+XAYkhmCTnD86Een/zVXQbVZy0naqKBJQgfN7OkYcZ4oekXdnfzcJZaOKKvNNFitJBVJ0AbvTbCIOV2aXnpg83liHOSgsutxia0jgASmMj3K1Qn1ZQ+JWEBq7WDl006+A2dRLFYed82BRA9fIDj1dBgNxPIwT/F06CjPulJS/fvh8JgFef5ySJ4dGPOdMAegYogAgxHEG8fz2+S+wwYqtNtxWJFR97oDc3aEUIU32ptp4QZYrUUrO61HQiLY=
  file:
    - "app/build/outputs/apk/debug/app-debug.apk"
    - "wear/build/outputs/apk/debug/wear-debug.apk"
  file_glob: "true"
  skip_cleanup: true
  on:
    repo: chitkiu/FinanceManager
