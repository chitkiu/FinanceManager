sudo: false
language: android
jdk: oraclejdk8
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
env:
  global:
  - ANDROID_API_LEVEL=28
  - ANDROID_BUILD_TOOLS_VERSION=28.0.3
  - ANDROID_ABI=google_apis/armeabi-v7a
  - ADB_INSTALL_TIMEOUT=20
android:
  components:
  - tools
  - platform-tools
  - build-tools-28.0.3
  - android-28
  - extra-google-m2repository
  - extra-android-m2repository
  - extra-google-google_play_services
  - extra-android-support
  - addon-google_apis-google-$ANDROID_API_LEVEL
script:
- "./gradlew clean"
- "./gradlew assembleDebug"

before_install:
- mkdir "$ANDROID_HOME/licenses" || true
- echo -e "\nd56f5187479451eabf01fb78af6dfcb131a6481e" > "$ANDROID_HOME/licenses/android-sdk-license"
- echo -e "\n84831b9409646a918e30573bab4c9c91346d8abd" > "$ANDROID_HOME/licenses/android-sdk-preview-license"
- chmod +x gradlew

deploy:
  provider: releases
  api_key:
    secure: 7vm4z3d3+JplXJovVrZlY5bSWaHcGoeD+M+q9rnb0PWKM5NKfnmbRYaVurY2VeBS+rQ9VmajD1t5b3A7lpBM89WIm/A5HdXIqFJy6Bhb0SQkW6hUUeEdASN/VaZwt9iFnzjXVJfIxRsVhlTUfgkTnvsCojR2HKg8trLsBqWN00f9y6W9c9QsqYvFA5Zswfw9oaldiuJTwg/oy791VB9XMkXd3v/c4MvBfsGWslB/nFlvruW27jUpUih5KFWf2mRma22up0OainD5wlYm5DPhDBmUntLoT87pW2U75mgFj7HqmOucN1d7ljEGcUTh6266G/MyCuzppco1fkGrRqQi+MSBk39QG1D5FgudukqqWdvHv9Oy/lMtamkd5aUWrJGw0ZODBKTbp+EPg3b9hncRtLl5waQMASNgJYWnhZtXRZ98JJLKyR3kGYGlQZo2bmJSJgZLxYBiGlXZLBF5p1rJJNk1/T5aKOFSlOmCSf4T7sCI6oZxBoQWPeigKjEiPmX8WTLujduOH2XjX/+2ad+A4DOknou+KFQLf1RNgdYMobQy4UuF64r0oeM7ld9uz/F0RevNYc09Mda2yqLRo/Mtu/VgXwSl7N4n5LdM8Ixg0psklDiZCDxLvPCB61JWVOTYOeF/csEBTbZbd8rNnsj1/2oKE3a/889o53LdWG7nAO4=
  file:
    - "app/build/outputs/apk/debug/app-debug.apk"
    - "wear/build/outputs/apk/debug/wear-debug.apk"
  file_glob: "true"
  skip_cleanup: true
  on:
    repo: chitkiu/FinanceManager
